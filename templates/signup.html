{% extends "base.html" %}

{% block title %}Sign Up - Pashuthalam{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="auth-card">
                    <div class="text-center mb-4">
                        <div class="mb-3">
                            <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Pashuthalam Logo" height="70" class="rounded-circle border shadow-sm" style="border-radius: 50%; object-fit: cover; padding: 5px;">
                        </div>
                        <h1 class="auth-brand mb-2" style="color: #90ee90; font-weight: 700; font-size: 2rem;">Pashuthalam</h1>
                        <h2 class="auth-title">Register Your Hospital/Clinic</h2>
                        <p class="text-muted">Create your Pashuthalam account to get started</p>
                    </div>

                    <form method="POST" id="signupForm">
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <label for="hospital_name" class="form-label fw-medium">
                                    <i class="fas fa-hospital me-2 text-muted"></i>Hospital/Clinic Name
                                </label>
                                <input type="text" class="form-control form-control-lg" id="hospital_name" name="hospital_name" 
                                       placeholder="Enter hospital/clinic name" value="{{ doctor_data.hospital_name if doctor_data else '' }}" required>
                                <div class="invalid-feedback">
                                    Please enter a valid hospital/clinic name.
                                </div>
                            </div>

                            <div class="col-md-6 mb-4">
                                <label for="doctor_name" class="form-label fw-medium">
                                    <i class="fas fa-user-md me-2 text-muted"></i>Doctor Name
                                </label>
                                <input type="text" class="form-control form-control-lg" id="doctor_name" name="doctor_name" 
                                       placeholder="Enter doctor name" value="{{ doctor_data.doctor_name if doctor_data else '' }}" required>
                                <div class="invalid-feedback">
                                    Please enter the doctor's name.
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <label for="mobile_no" class="form-label fw-medium">
                                    <i class="fas fa-mobile-alt me-2 text-muted"></i>Mobile Number
                                </label>
                                <input type="tel" class="form-control form-control-lg" id="mobile_no" name="mobile_no" 
                                       placeholder="10-digit mobile number" value="{{ doctor_data.mobile_no if doctor_data else '' }}"
                                       pattern="[0-9]{10}" maxlength="10" required>
                                <div class="invalid-feedback">
                                    Please enter a valid 10-digit mobile number.
                                </div>
                            </div>

                            <div class="col-md-6 mb-4">
                                <label for="pincode" class="form-label fw-medium">
                                    <i class="fas fa-map-pin me-2 text-muted"></i>Pincode
                                </label>
                                <input type="text" class="form-control form-control-lg" id="pincode" name="pincode" 
                                       placeholder="6-digit pincode" value="{{ doctor_data.pincode if doctor_data else '' }}"
                                       pattern="[0-9]{6}" maxlength="6" required>
                                <div class="invalid-feedback">
                                    Please enter a valid 6-digit pincode.
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="address" class="form-label fw-medium">
                                <i class="fas fa-map-marker-alt me-2 text-muted"></i>Address
                            </label>
                            <textarea class="form-control form-control-lg" id="address" name="address" rows="3" 
                                      placeholder="Enter complete address" required>{{ doctor_data.address if doctor_data else '' }}</textarea>
                            <div class="invalid-feedback">
                                Please enter a complete address.
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="map_link" class="form-label fw-medium">
                                <i class="fas fa-link me-2 text-muted"></i>Map Link (Optional)
                            </label>
                            <input type="url" class="form-control form-control-lg" id="map_link" name="map_link" 
                                   placeholder="Google Maps or other map link" value="{{ doctor_data.map_link if doctor_data else '' }}">
                            <div class="form-text text-muted">Add a Google Maps link for better location visibility</div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <label for="password" class="form-label fw-medium">
                                    <i class="fas fa-lock me-2 text-muted"></i>Password
                                </label>
                                <div class="input-group">
                                    <input type="password" class="form-control form-control-lg" id="password" name="password" 
                                           placeholder="Enter password" minlength="6" required>
                                    <button class="btn btn-outline-success" type="button" id="togglePassword">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <div class="form-text text-muted">Password must be at least 6 characters long</div>
                                <div class="invalid-feedback">
                                    Password must be at least 6 characters long.
                                </div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="confirm_password" class="form-label">
                                    <i class="fas fa-lock me-2"></i>Confirm Password *
                                </label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="confirm_password" name="confirm_password" 
                                           placeholder="Confirm password" minlength="6" required>
                                    <button class="btn btn-outline-success" type="button" id="toggleConfirmPassword">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <div class="invalid-feedback">
                                    Passwords do not match.
                                </div>
                            </div>
                        </div>

                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="terms" required>
                            <label class="form-check-label" for="terms">
                                I agree to the <a href="#" class="text-decoration-none">Terms and Conditions</a>
                            </label>
                            <div class="invalid-feedback">
                                You must agree to the terms and conditions.
                            </div>
                        </div>

                        <button type="submit" class="btn btn-success w-100 mb-3">
                            <i class="fas fa-user-plus me-2"></i>Create Account
                        </button>

                        <div class="text-center">
                            <p class="mb-0">Already have an account? 
                                <a href="{{ url_for('login') }}" class="text-decoration-none text-success fw-medium">
                                    Login here
                                </a>
                            </p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Toggle password visibility
    function togglePasswordVisibility(buttonId, inputId) {
        document.getElementById(buttonId).addEventListener('click', function() {
            const password = document.getElementById(inputId);
            const icon = this.querySelector('i');
            
            if (password.type === 'password') {
                password.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                password.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        });
    }

    togglePasswordVisibility('togglePassword', 'password');
    togglePasswordVisibility('toggleConfirmPassword', 'confirm_password');

    // Mobile number validation
    document.getElementById('mobile_no').addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
        if (this.value.length > 10) {
            this.value = this.value.slice(0, 10);
        }
    });

    // Pincode validation
    document.getElementById('pincode').addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
        if (this.value.length > 6) {
            this.value = this.value.slice(0, 6);
        }
    });

    // Password confirmation validation
    document.getElementById('confirm_password').addEventListener('input', function() {
        const password = document.getElementById('password').value;
        const confirmPassword = this.value;
        
        if (password !== confirmPassword) {
            this.classList.add('is-invalid');
        } else {
            this.classList.remove('is-invalid');
        }
    });

    // Form validation
    document.getElementById('signupForm').addEventListener('submit', function(e) {
        let isValid = true;
        
        // Reset all validation classes
        const inputs = this.querySelectorAll('.form-control, .form-check-input');
        inputs.forEach(input => {
            input.classList.remove('is-invalid');
        });

        // Validate required fields
        const requiredFields = ['hospital_name', 'doctor_name', 'mobile_no', 'pincode', 'address', 'password', 'confirm_password'];
        requiredFields.forEach(fieldName => {
            const field = document.getElementById(fieldName);
            if (!field.value.trim()) {
                field.classList.add('is-invalid');
                isValid = false;
            }
        });

        // Validate mobile number
        const mobileNo = document.getElementById('mobile_no').value;
        if (mobileNo.length !== 10) {
            document.getElementById('mobile_no').classList.add('is-invalid');
            isValid = false;
        }

        // Validate pincode
        const pincode = document.getElementById('pincode').value;
        if (pincode.length !== 6) {
            document.getElementById('pincode').classList.add('is-invalid');
            isValid = false;
        }

        // Validate password length
        const password = document.getElementById('password').value;
        if (password.length < 6) {
            document.getElementById('password').classList.add('is-invalid');
            isValid = false;
        }

        // Validate password confirmation
        const confirmPassword = document.getElementById('confirm_password').value;
        if (password !== confirmPassword) {
            document.getElementById('confirm_password').classList.add('is-invalid');
            isValid = false;
        }

        // Validate terms checkbox
        const terms = document.getElementById('terms');
        if (!terms.checked) {
            terms.classList.add('is-invalid');
            isValid = false;
        }

        if (!isValid) {
            e.preventDefault();
        }
    });
</script>
{% endblock %}